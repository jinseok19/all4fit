<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ | ëª¨ë‘ì˜í•</title>
  <meta name="description" content="ëª¨ë‘ì˜í• ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ">
  <meta name="robots" content="noindex, nofollow">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css"></noscript>

  <!-- CSS -->
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/components.css">
</head>
<body>
  <a class="skip-link" href="#main">ë³¸ë¬¸ìœ¼ë¡œ ë°”ë¡œê°€ê¸°</a>
  
  <header id="site-header"></header>
  <div class="breadcrumb" id="breadcrumb"></div>
  
  <main id="main">
    <div class="admin-container">
      <div class="admin-header">
        <div class="admin-title">
          <h1>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
          <p>ëª¨ë‘ì˜í• ì‹œìŠ¤í…œ ê´€ë¦¬</p>
        </div>
        <div class="admin-actions">
          <button class="btn btn-primary" id="resetDataBtn">
            <span>ğŸ”„</span> ë°ëª¨ ë°ì´í„° ë¦¬ì…‹
          </button>
          <div class="admin-user">
            <span>ê´€ë¦¬ìë‹˜</span>
            <button class="btn" onclick="auth.logout()">ë¡œê·¸ì•„ì›ƒ</button>
          </div>
        </div>
      </div>

      <!-- KPI ì¹´ë“œë“¤ -->
      <div class="kpi-section">
        <div class="kpi-grid" id="kpiCards">
          <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
        </div>
      </div>

      <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
      <div class="admin-tabs">
        <nav class="tabs" id="adminTabs">
          <ul class="tabs-nav">
            <li><button class="tab-btn active" data-tab="dashboard">ëŒ€ì‹œë³´ë“œ</button></li>
            <li><button class="tab-btn" data-tab="facilities">ì²´ìœ¡ì‹œì„¤</button></li>
            <li><button class="tab-btn" data-tab="coaches">ì§€ë„ì</button></li>
            <li><button class="tab-btn" data-tab="programs">í”„ë¡œê·¸ë¨</button></li>
            <li><button class="tab-btn" data-tab="notices">ê³µì§€ì‚¬í•­</button></li>
            <li><button class="tab-btn" data-tab="users">íšŒì›ê´€ë¦¬</button></li>
            <li><button class="tab-btn" data-tab="bookings">ì˜ˆì•½ê´€ë¦¬</button></li>
          </ul>
        </nav>

        <!-- ëŒ€ì‹œë³´ë“œ íƒ­ -->
        <div class="tab-content active" id="dashboard">
          <div class="dashboard-section">
            <h2>ìµœê·¼ í™œë™</h2>
            <div class="activity-cards">
              <div class="activity-card">
                <h3>ì˜¤ëŠ˜ì˜ ì˜ˆì•½</h3>
                <div class="activity-stats">
                  <span class="stat-number" id="todayBookings">0</span>
                  <span class="stat-label">ê±´</span>
                </div>
              </div>
              <div class="activity-card">
                <h3>ì‹ ê·œ íšŒì›</h3>
                <div class="activity-stats">
                  <span class="stat-number" id="newUsers">0</span>
                  <span class="stat-label">ëª…</span>
                </div>
              </div>
              <div class="activity-card">
                <h3>ì´ìš©ë¥ </h3>
                <div class="activity-stats">
                  <span class="stat-number" id="utilizationRate">0</span>
                  <span class="stat-label">%</span>
                </div>
              </div>
            </div>
            
            <div class="quick-actions">
              <h3>ë¹ ë¥¸ ì‘ì—…</h3>
              <div class="quick-action-grid">
                <button class="quick-action-btn" data-action="add-facility">
                  <span class="action-icon">ğŸ¢</span>
                  <span>ì‹œì„¤ ì¶”ê°€</span>
                </button>
                <button class="quick-action-btn" data-action="add-program">
                  <span class="action-icon">ğŸ“</span>
                  <span>í”„ë¡œê·¸ë¨ ì¶”ê°€</span>
                </button>
                <button class="quick-action-btn" data-action="add-coach">
                  <span class="action-icon">ğŸ‘¨â€ğŸ«</span>
                  <span>ì§€ë„ì ì¶”ê°€</span>
                </button>
                <button class="quick-action-btn" data-action="add-notice">
                  <span class="action-icon">ğŸ“¢</span>
                  <span>ê³µì§€ì‚¬í•­ ì‘ì„±</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- ì²´ìœ¡ì‹œì„¤ íƒ­ -->
        <div class="tab-content" id="facilities">
          <div class="content-header">
            <h2>ì²´ìœ¡ì‹œì„¤ ê´€ë¦¬</h2>
            <button class="btn btn-primary" id="addFacilityBtn">+ ìƒˆ ì‹œì„¤ ì¶”ê°€</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="ì‹œì„¤ ê²€ìƒ‰..." class="table-search" data-table="facilities">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="facilities" data-field="status">
                <option value="">ì „ì²´ ìƒíƒœ</option>
                <option value="active">ìš´ì˜ì¤‘</option>
                <option value="inactive">íœ´ì—…</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="facilitiesTable">
              <thead>
                <tr>
                  <th>ì‹œì„¤ëª…</th>
                  <th>ìœ í˜•</th>
                  <th>ì§€ì—­</th>
                  <th>ìƒíƒœ</th>
                  <th>í‰ì </th>
                  <th>ë“±ë¡ì¼</th>
                  <th>ì‘ì—…</th>
                </tr>
              </thead>
              <tbody>
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="facilitiesPagination"></div>
        </div>

        <!-- ì§€ë„ì íƒ­ -->
        <div class="tab-content" id="coaches">
          <div class="content-header">
            <h2>ì§€ë„ì ê´€ë¦¬</h2>
            <button class="btn btn-primary" id="addCoachBtn">+ ìƒˆ ì§€ë„ì ë“±ë¡</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="ì§€ë„ì ê²€ìƒ‰..." class="table-search" data-table="coaches">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="coaches" data-field="status">
                <option value="">ì „ì²´ ìƒíƒœ</option>
                <option value="active">í™œë™ì¤‘</option>
                <option value="inactive">íœ´ì§</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="coachesTable">
              <thead>
                <tr>
                  <th>ì´ë¦„</th>
                  <th>ì „ë¬¸ë¶„ì•¼</th>
                  <th>ê²½ë ¥</th>
                  <th>í‰ì </th>
                  <th>ì‹œê¸‰</th>
                  <th>ìƒíƒœ</th>
                  <th>ì‘ì—…</th>
                </tr>
              </thead>
              <tbody>
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="coachesPagination"></div>
        </div>

        <!-- í”„ë¡œê·¸ë¨ íƒ­ -->
        <div class="tab-content" id="programs">
          <div class="content-header">
            <h2>í”„ë¡œê·¸ë¨ ê´€ë¦¬</h2>
            <button class="btn btn-primary" id="addProgramBtn">+ ìƒˆ í”„ë¡œê·¸ë¨ ì¶”ê°€</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="í”„ë¡œê·¸ë¨ ê²€ìƒ‰..." class="table-search" data-table="programs">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="programs" data-field="status">
                <option value="">ì „ì²´ ìƒíƒœ</option>
                <option value="active">ìš´ì˜ì¤‘</option>
                <option value="inactive">ì¤‘ë‹¨</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="programsTable">
              <thead>
                <tr>
                  <th>í”„ë¡œê·¸ë¨ëª…</th>
                  <th>ì¹´í…Œê³ ë¦¬</th>
                  <th>ìˆ˜ì¤€</th>
                  <th>ì •ì›</th>
                  <th>í˜„ì¬ì¸ì›</th>
                  <th>ê°€ê²©</th>
                  <th>ìƒíƒœ</th>
                  <th>ì‘ì—…</th>
                </tr>
              </thead>
              <tbody>
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="programsPagination"></div>
        </div>

        <!-- ê³µì§€ì‚¬í•­ íƒ­ -->
        <div class="tab-content" id="notices">
          <div class="content-header">
            <h2>ê³µì§€ì‚¬í•­ ê´€ë¦¬</h2>
            <button class="btn btn-primary" id="addNoticeBtn">+ ìƒˆ ê³µì§€ì‚¬í•­ ì‘ì„±</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="ê³µì§€ì‚¬í•­ ê²€ìƒ‰..." class="table-search" data-table="notices">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="notices" data-field="status">
                <option value="">ì „ì²´ ìƒíƒœ</option>
                <option value="published">ê²Œì‹œë¨</option>
                <option value="draft">ì„ì‹œì €ì¥</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="noticesTable">
              <thead>
                <tr>
                  <th>ì œëª©</th>
                  <th>ì¹´í…Œê³ ë¦¬</th>
                  <th>ìš°ì„ ìˆœìœ„</th>
                  <th>ì¡°íšŒìˆ˜</th>
                  <th>ìƒíƒœ</th>
                  <th>ì‘ì„±ì¼</th>
                  <th>ì‘ì—…</th>
                </tr>
              </thead>
              <tbody>
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="noticesPagination"></div>
        </div>

        <!-- íšŒì›ê´€ë¦¬ íƒ­ -->
        <div class="tab-content" id="users">
          <div class="content-header">
            <h2>íšŒì› ê´€ë¦¬</h2>
            <div class="header-stats">
              <span>ì´ íšŒì›ìˆ˜: <strong id="totalUsers">0</strong>ëª…</span>
            </div>
          </div>
          <div class="users-placeholder">
            <div class="placeholder-content">
              <div class="placeholder-icon">ğŸ‘¥</div>
              <h3>íšŒì› ê´€ë¦¬ ì‹œìŠ¤í…œ</h3>
              <p>ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ì—¬ê¸°ì— íšŒì› ëª©ë¡ê³¼ ê´€ë¦¬ ê¸°ëŠ¥ì´ í‘œì‹œë©ë‹ˆë‹¤.</p>
              <div class="placeholder-features">
                <div class="feature">âœ“ íšŒì› ì •ë³´ ì¡°íšŒ ë° ìˆ˜ì •</div>
                <div class="feature">âœ“ íšŒì› ë“±ê¸‰ ê´€ë¦¬</div>
                <div class="feature">âœ“ í™œë™ ë‚´ì—­ ì¡°íšŒ</div>
                <div class="feature">âœ“ íƒˆí‡´ ì²˜ë¦¬</div>
              </div>
            </div>
          </div>
        </div>

        <!-- ì˜ˆì•½ê´€ë¦¬ íƒ­ -->
        <div class="tab-content" id="bookings">
          <div class="content-header">
            <h2>ì˜ˆì•½ ê´€ë¦¬</h2>
            <div class="header-stats">
              <span>ì´ ì˜ˆì•½ìˆ˜: <strong id="totalBookings">0</strong>ê±´</span>
            </div>
          </div>
          <div class="bookings-list" id="bookingsList">
            <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
          </div>
        </div>
      </div>
    </div>

    <!-- ëª¨ë‹¬ ì˜ì—­ -->
    <div id="modalContainer"></div>
  </main>
  
  <footer id="site-footer"></footer>

  <script type="module" defer>
    import { mountHeader, mountFooter, mountBreadcrumb } from '/components/layout.js';
    import { auth } from '/js/auth.js';
    import { store } from '/js/store.js';
    import UIComponents from '/js/ui.js';
    
    // ì¸ì¦ ì²´í¬
    if (!auth.guard('admin')) {
      // auth.jsì—ì„œ ìë™ìœ¼ë¡œ ë¦¬ë””ë ‰ì…˜ë¨
    }

    // ë ˆì´ì•„ì›ƒ ë§ˆìš´íŠ¸
    mountHeader(document.getElementById('site-header'), { activePath: '/admin/' });
    mountBreadcrumb(document.getElementById('breadcrumb'), [
      { label: 'í™ˆ', href: '/' }, 
      { label: 'ê´€ë¦¬ì' }
    ]);
    mountFooter(document.getElementById('site-footer'));

    // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ í´ë˜ìŠ¤
    class AdminDashboard {
      constructor() {
        this.currentPage = {};
        this.init();
      }

      async init() {
        this.setupTabs();
        this.setupEventListeners();
        await this.loadDashboardData();
      }

      setupTabs() {
        UIComponents.initTabs(document.getElementById('adminTabs'));
      }

      setupEventListeners() {
        // ë°ì´í„° ë¦¬ì…‹ ë²„íŠ¼
        document.getElementById('resetDataBtn').addEventListener('click', () => {
          this.resetDemoData();
        });

        // íƒ­ ë³€ê²½ ì´ë²¤íŠ¸
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', async () => {
            const tabName = btn.dataset.tab;
            await this.loadTabData(tabName);
          });
        });

        // ë¹ ë¥¸ ì‘ì—… ë²„íŠ¼ë“¤
        document.querySelectorAll('.quick-action-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const action = btn.dataset.action;
            this.handleQuickAction(action);
          });
        });

        // ì¶”ê°€ ë²„íŠ¼ë“¤
        document.getElementById('addFacilityBtn')?.addEventListener('click', () => this.showAddModal('facilities'));
        document.getElementById('addCoachBtn')?.addEventListener('click', () => this.showAddModal('coaches'));
        document.getElementById('addProgramBtn')?.addEventListener('click', () => this.showAddModal('programs'));
        document.getElementById('addNoticeBtn')?.addEventListener('click', () => this.showAddModal('notices'));

        // ê²€ìƒ‰ ë° í•„í„°
        this.setupTableControls();
      }

      setupTableControls() {
        document.querySelectorAll('.table-search').forEach(input => {
          input.addEventListener('input', UIComponents.debounce(() => {
            const table = input.dataset.table;
            this.filterTable(table);
          }, 300));
        });

        document.querySelectorAll('.table-filter').forEach(select => {
          select.addEventListener('change', () => {
            const table = select.dataset.table;
            this.filterTable(table);
          });
        });
      }

      async loadDashboardData() {
        try {
          // KPI ë°ì´í„° ë¡œë“œ
          const [facilities, programs, coaches, notices] = await Promise.all([
            store.getData('facilities'),
            store.getData('programs'),
            store.getData('coaches'),
            store.getData('notices')
          ]);

          this.renderKPI({
            facilities: facilities.length,
            programs: programs.length,
            coaches: coaches.length,
            notices: notices.length,
            activeFacilities: facilities.filter(f => f.status === 'active').length,
            activePrograms: programs.filter(p => p.status === 'active').length,
          });

          // í™œë™ í†µê³„
          this.updateActivityStats();
          
          // ì˜ˆì•½ ë°ì´í„° ë¡œë“œ
          await this.loadBookingsData();

        } catch (error) {
          console.error('Dashboard load error:', error);
          UIComponents.showToast('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
      }

      renderKPI(stats) {
        document.getElementById('kpiCards').innerHTML = `
          <div class="kpi-card">
            <div class="kpi-value">${stats.facilities}</div>
            <div class="kpi-label">ì´ ì²´ìœ¡ì‹œì„¤</div>
            <div class="kpi-sub">${stats.activeFacilities}ê°œ ìš´ì˜ì¤‘</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">${stats.programs}</div>
            <div class="kpi-label">ì´ í”„ë¡œê·¸ë¨</div>
            <div class="kpi-sub">${stats.activePrograms}ê°œ ìš´ì˜ì¤‘</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">${stats.coaches}</div>
            <div class="kpi-label">ì „ë¬¸ ì§€ë„ì</div>
            <div class="kpi-sub">í‰ê·  í‰ì  4.7</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">${stats.notices}</div>
            <div class="kpi-label">ê³µì§€ì‚¬í•­</div>
            <div class="kpi-sub">ì´ë²ˆ ë‹¬ ì‹ ê·œ</div>
          </div>
        `;
      }

      updateActivityStats() {
        // ëª¨ì˜ ë°ì´í„°
        document.getElementById('todayBookings').textContent = '12';
        document.getElementById('newUsers').textContent = '5';
        document.getElementById('utilizationRate').textContent = '78';
      }

      async loadTabData(tabName) {
        switch (tabName) {
          case 'facilities':
            await this.loadFacilitiesTable();
            break;
          case 'coaches':
            await this.loadCoachesTable();
            break;
          case 'programs':
            await this.loadProgramsTable();
            break;
          case 'notices':
            await this.loadNoticesTable();
            break;
          case 'bookings':
            await this.loadBookingsData();
            break;
        }
      }

      async loadFacilitiesTable() {
        try {
          const facilities = await store.getData('facilities');
          const tbody = document.querySelector('#facilitiesTable tbody');
          
          tbody.innerHTML = facilities.map(facility => `
            <tr data-id="${facility.id}">
              <td>
                <div class="table-title">${facility.name}</div>
                <div class="table-sub">${facility.location.district}</div>
              </td>
              <td><span class="badge">${facility.category}</span></td>
              <td>${facility.location.district}</td>
              <td>
                <span class="status status-${facility.status}">
                  <span class="status-dot"></span>
                  ${facility.status === 'active' ? 'ìš´ì˜ì¤‘' : 'íœ´ì—…'}
                </span>
              </td>
              <td>${facility.rating} â­</td>
              <td>${new Date(facility.createdAt).toLocaleDateString('ko-KR')}</td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('facilities', '${facility.id}')" title="ìˆ˜ì •">âœï¸</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('facilities', '${facility.id}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Facilities table load error:', error);
        }
      }

      async loadCoachesTable() {
        try {
          const coaches = await store.getData('coaches');
          const tbody = document.querySelector('#coachesTable tbody');
          
          tbody.innerHTML = coaches.map(coach => `
            <tr data-id="${coach.id}">
              <td>
                <div class="table-title">${coach.name}</div>
                <div class="table-sub">${coach.experience}ë…„ ê²½ë ¥</div>
              </td>
              <td>
                <div class="specialties-tags">
                  ${coach.specialties.slice(0, 2).map(s => `<span class="tag">${s}</span>`).join('')}
                </div>
              </td>
              <td>${coach.experience}ë…„</td>
              <td>${coach.rating} â­</td>
              <td>${coach.hourlyRate.toLocaleString()}ì›</td>
              <td>
                <span class="status status-${coach.status}">
                  <span class="status-dot"></span>
                  ${coach.status === 'active' ? 'í™œë™ì¤‘' : 'íœ´ì§'}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('coaches', '${coach.id}')" title="ìˆ˜ì •">âœï¸</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('coaches', '${coach.id}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Coaches table load error:', error);
        }
      }

      async loadProgramsTable() {
        try {
          const programs = await store.getData('programs');
          const tbody = document.querySelector('#programsTable tbody');
          
          tbody.innerHTML = programs.map(program => `
            <tr data-id="${program.id}">
              <td>
                <div class="table-title">${program.title}</div>
                <div class="table-sub">${program.duration}ë¶„</div>
              </td>
              <td><span class="badge">${program.category}</span></td>
              <td>
                <span class="level-badge level-${program.level}">
                  ${program.level === 'beginner' ? 'ì´ˆê¸‰' : program.level === 'intermediate' ? 'ì¤‘ê¸‰' : 'ê³ ê¸‰'}
                </span>
              </td>
              <td>${program.maxParticipants}ëª…</td>
              <td>${program.currentParticipants}ëª…</td>
              <td>${program.price.toLocaleString()}ì›</td>
              <td>
                <span class="status status-${program.status}">
                  <span class="status-dot"></span>
                  ${program.status === 'active' ? 'ìš´ì˜ì¤‘' : 'ì¤‘ë‹¨'}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('programs', '${program.id}')" title="ìˆ˜ì •">âœï¸</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('programs', '${program.id}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Programs table load error:', error);
        }
      }

      async loadNoticesTable() {
        try {
          const notices = await store.getData('notices');
          const tbody = document.querySelector('#noticesTable tbody');
          
          tbody.innerHTML = notices.map(notice => `
            <tr data-id="${notice.id}">
              <td>
                <div class="table-title">${notice.title}</div>
                <div class="table-sub">by ${notice.author}</div>
              </td>
              <td><span class="badge">${notice.category}</span></td>
              <td>
                <span class="priority priority-${notice.priority}">
                  ${notice.priority === 'high' ? 'ë†’ìŒ' : notice.priority === 'medium' ? 'ë³´í†µ' : 'ë‚®ìŒ'}
                </span>
              </td>
              <td>${notice.views || 0}</td>
              <td>
                <span class="status status-${notice.status}">
                  <span class="status-dot"></span>
                  ${notice.status === 'published' ? 'ê²Œì‹œë¨' : 'ì„ì‹œì €ì¥'}
                </span>
              </td>
              <td>${new Date(notice.createdAt).toLocaleDateString('ko-KR')}</td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('notices', '${notice.id}')" title="ìˆ˜ì •">âœï¸</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('notices', '${notice.id}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Notices table load error:', error);
        }
      }

      async loadBookingsData() {
        try {
          const bookings = JSON.parse(localStorage.getItem('allfit_bookings') || '[]');
          document.getElementById('totalBookings').textContent = bookings.length;
          
          const bookingsList = document.getElementById('bookingsList');
          
          if (bookings.length === 0) {
            bookingsList.innerHTML = `
              <div class="empty-state">
                <div class="empty-icon">ğŸ“…</div>
                <p>ì•„ì§ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</p>
              </div>
            `;
            return;
          }

          bookingsList.innerHTML = `
            <div class="bookings-grid">
              ${bookings.slice(0, 20).map(booking => `
                <div class="booking-card">
                  <div class="booking-header">
                    <div class="booking-id">${booking.id}</div>
                    <span class="booking-status status-${booking.status}">
                      ${booking.status === 'pending' ? 'ëŒ€ê¸°ì¤‘' : booking.status === 'confirmed' ? 'í™•ì •' : 'ì·¨ì†Œ'}
                    </span>
                  </div>
                  <div class="booking-details">
                    <div class="booking-info">
                      <strong>${booking.name}</strong>
                      <div>ğŸ“ ${booking.phone}</div>
                      <div>ğŸ“§ ${booking.email}</div>
                    </div>
                    <div class="booking-schedule">
                      <div>ğŸ“… ${booking.date}</div>
                      <div>ğŸ• ${booking.time}</div>
                      <div>ğŸ‘¥ ${booking.participants}ëª…</div>
                    </div>
                  </div>
                  <div class="booking-footer">
                    <span class="booking-price">${parseInt(booking.totalPrice).toLocaleString()}ì›</span>
                    <div class="booking-actions">
                      <button class="btn btn-sm" onclick="adminDashboard.confirmBooking('${booking.id}')">í™•ì •</button>
                      <button class="btn btn-sm">ì·¨ì†Œ</button>
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
          `;
        } catch (error) {
          console.error('Bookings load error:', error);
        }
      }

      filterTable(tableName) {
        // í…Œì´ë¸” í•„í„°ë§ êµ¬í˜„ (ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ ë¡œì§)
        console.log(`Filtering ${tableName} table`);
      }

      handleQuickAction(action) {
        switch (action) {
          case 'add-facility':
            this.showAddModal('facilities');
            break;
          case 'add-program':
            this.showAddModal('programs');
            break;
          case 'add-coach':
            this.showAddModal('coaches');
            break;
          case 'add-notice':
            this.showAddModal('notices');
            break;
        }
      }

      showAddModal(type) {
        const titles = {
          facilities: 'ìƒˆ ì²´ìœ¡ì‹œì„¤ ì¶”ê°€',
          programs: 'ìƒˆ í”„ë¡œê·¸ë¨ ì¶”ê°€',
          coaches: 'ìƒˆ ì§€ë„ì ë“±ë¡',
          notices: 'ìƒˆ ê³µì§€ì‚¬í•­ ì‘ì„±'
        };

        const content = this.getAddFormContent(type);
        
        UIComponents.showModal(content, {
          title: titles[type],
          size: 'large'
        });
      }

      getAddFormContent(type) {
        // ê°„ë‹¨í•œ í¼ (ì‹¤ì œë¡œëŠ” ë” ìƒì„¸í•œ í¼ì´ í•„ìš”)
        switch (type) {
          case 'facilities':
            return `
              <form id="addFacilityForm" class="modal-form">
                <div class="form-group">
                  <label>ì‹œì„¤ëª…</label>
                  <input type="text" name="name" required>
                </div>
                <div class="form-group">
                  <label>ìœ í˜•</label>
                  <select name="type" required>
                    <option value="gymnasium">ì²´ìœ¡ê´€</option>
                    <option value="sports_center">ìŠ¤í¬ì¸ ì„¼í„°</option>
                    <option value="swimming_pool">ìˆ˜ì˜ì¥</option>
                    <option value="tennis_court">í…Œë‹ˆìŠ¤ì¥</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>ì£¼ì†Œ</label>
                  <input type="text" name="address" required>
                </div>
                <div class="form-group">
                  <label>ì„¤ëª…</label>
                  <textarea name="description" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                  <button type="button" class="btn" onclick="this.closest('.modal-overlay').querySelector('.modal-close').click()">ì·¨ì†Œ</button>
                  <button type="submit" class="btn btn-primary">ì¶”ê°€</button>
                </div>
              </form>
            `;
          default:
            return `
              <div class="modal-placeholder">
                <p>ì´ ê¸°ëŠ¥ì€ ë°ëª¨ ë²„ì „ì—ì„œ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
                <p>ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ìƒì„¸í•œ ì¶”ê°€/í¸ì§‘ í¼ì´ ì œê³µë©ë‹ˆë‹¤.</p>
              </div>
            `;
        }
      }

      editItem(type, id) {
        UIComponents.showToast(`${type} ${id} í¸ì§‘ ê¸°ëŠ¥ì€ ë°ëª¨ì—ì„œ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`, 'info');
      }

      async deleteItem(type, id) {
        if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          try {
            await store.delete(type, id);
            UIComponents.showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            await this.loadTabData(type);
          } catch (error) {
            console.error('Delete error:', error);
            UIComponents.showToast('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
          }
        }
      }

      confirmBooking(bookingId) {
        // ì˜ˆì•½ í™•ì • ì²˜ë¦¬
        UIComponents.showToast(`ì˜ˆì•½ ${bookingId}ì´ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
      }

      resetDemoData() {
        if (confirm('ëª¨ë“  ë°ëª¨ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          store.resetDemoData();
          localStorage.removeItem('allfit_bookings');
          UIComponents.showToast('ë°ëª¨ ë°ì´í„°ê°€ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          setTimeout(() => {
            window.location.reload();
          }, 1000);
        }
      }
    }

    // ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì • (onClick í•¸ë“¤ëŸ¬ìš©)
    window.adminDashboard = new AdminDashboard();
  </script>

  <style>
    /* ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì „ìš© ìŠ¤íƒ€ì¼ */
    .admin-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2rem 0;
      border-bottom: 1px solid var(--line);
      margin-bottom: 2rem;
    }

    .admin-title h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .admin-title p {
      color: var(--muted);
      margin: 0;
    }

    .admin-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .admin-user {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding-left: 1rem;
      border-left: 1px solid var(--line);
    }

    .kpi-section {
      margin-bottom: 3rem;
    }

    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .kpi-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 2rem;
      text-align: center;
      transition: all 0.2s ease;
    }

    .kpi-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px var(--shadow);
    }

    .kpi-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--brand);
      margin-bottom: 0.5rem;
    }

    .kpi-label {
      font-size: 1rem;
      color: var(--ink);
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .kpi-sub {
      font-size: 0.875rem;
      color: var(--muted);
    }

    .admin-tabs {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      overflow: hidden;
    }

    .tabs-nav {
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--line);
      padding: 0;
      display: flex;
      overflow-x: auto;
    }

    .tab-btn {
      padding: 1rem 1.5rem;
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-weight: 500;
      white-space: nowrap;
      transition: all 0.2s ease;
      border-bottom: 3px solid transparent;
    }

    .tab-btn:hover {
      background: var(--card);
      color: var(--ink);
    }

    .tab-btn.active {
      color: var(--brand);
      background: var(--card);
      border-bottom-color: var(--brand);
    }

    .tab-content {
      padding: 2rem;
      min-height: 400px;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .header-stats {
      color: var(--muted);
      font-size: 0.9375rem;
    }

    .table-controls {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      align-items: center;
    }

    .search-wrapper,
    .filter-wrapper {
      flex: 1;
      max-width: 300px;
    }

    .table-search,
    .table-filter {
      width: 100%;
    }

    .table-title {
      font-weight: 600;
      color: var(--ink);
    }

    .table-sub {
      font-size: 0.875rem;
      color: var(--muted);
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-icon {
      background: none;
      border: none;
      padding: 0.5rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s ease;
    }

    .btn-icon:hover {
      background: var(--line);
    }

    .specialties-tags,
    .facilities-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
    }

    .level-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.8125rem;
      font-weight: 500;
    }

    .level-beginner { background: rgba(34, 211, 238, 0.1); color: var(--accent); }
    .level-intermediate { background: rgba(245, 158, 11, 0.1); color: var(--warn); }
    .level-advanced { background: rgba(239, 68, 68, 0.1); color: var(--bad); }

    .priority {
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.8125rem;
      font-weight: 500;
    }

    .priority-high { background: rgba(239, 68, 68, 0.1); color: var(--bad); }
    .priority-medium { background: rgba(245, 158, 11, 0.1); color: var(--warn); }
    .priority-low { background: rgba(107, 114, 128, 0.1); color: var(--muted); }

    /* ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ */
    .dashboard-section h2 {
      margin-bottom: 2rem;
    }

    .activity-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .activity-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 1.5rem;
      text-align: center;
    }

    .activity-card h3 {
      font-size: 1rem;
      color: var(--muted);
      margin-bottom: 1rem;
    }

    .activity-stats {
      display: flex;
      align-items: baseline;
      justify-content: center;
      gap: 0.5rem;
    }

    .activity-stats .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: var(--brand);
    }

    .activity-stats .stat-label {
      color: var(--muted);
    }

    .quick-actions h3 {
      margin-bottom: 1.5rem;
    }

    .quick-action-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
    }

    .quick-action-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
      padding: 1.5rem;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      color: var(--ink);
    }

    .quick-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px var(--shadow);
      border-color: var(--brand);
    }

    .action-icon {
      font-size: 2rem;
    }

    /* ì˜ˆì•½ ê´€ë¦¬ */
    .bookings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1.5rem;
    }

    .booking-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 1.5rem;
    }

    .booking-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .booking-id {
      font-weight: 600;
      color: var(--muted);
      font-size: 0.875rem;
    }

    .booking-details {
      margin-bottom: 1rem;
    }

    .booking-info,
    .booking-schedule {
      margin-bottom: 0.75rem;
    }

    .booking-info strong {
      display: block;
      color: var(--ink);
      margin-bottom: 0.5rem;
    }

    .booking-info div,
    .booking-schedule div {
      font-size: 0.875rem;
      color: var(--muted);
      margin-bottom: 0.25rem;
    }

    .booking-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .booking-price {
      font-weight: 700;
      color: var(--brand);
    }

    .booking-actions {
      display: flex;
      gap: 0.5rem;
    }

    .booking-status {
      font-size: 0.8125rem;
    }

    /* í”Œë ˆì´ìŠ¤í™€ë” */
    .users-placeholder,
    .modal-placeholder {
      text-align: center;
      padding: 3rem;
      color: var(--muted);
    }

    .placeholder-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .placeholder-features {
      margin-top: 2rem;
    }

    .feature {
      margin-bottom: 0.5rem;
      color: var(--ink-secondary);
    }

    /* ëª¨ë‹¬ í¼ */
    .modal-form {
      max-width: 500px;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--line);
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .admin-header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }
      
      .admin-actions {
        flex-direction: column;
      }
      
      .admin-user {
        border-left: none;
        border-top: 1px solid var(--line);
        padding-left: 0;
        padding-top: 1rem;
      }
      
      .content-header {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
      }
      
      .table-controls {
        flex-direction: column;
      }
      
      .search-wrapper,
      .filter-wrapper {
        max-width: none;
      }
    }
  </style>
</body>
</html>
