<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>관리자 대시보드 | 모두의핏</title>
  <meta name="description" content="모두의핏 관리자 대시보드">
  <meta name="robots" content="noindex, nofollow">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css"></noscript>

  <!-- CSS -->
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/components.css">
</head>
<body>
  <a class="skip-link" href="#main">본문으로 바로가기</a>
  
  <header id="site-header"></header>
  <div class="breadcrumb" id="breadcrumb"></div>
  
  <main id="main">
    <div class="admin-container">
      <div class="admin-header">
        <div class="admin-title">
          <h1>관리자 대시보드</h1>
          <p>모두의핏 시스템 관리</p>
        </div>
        <div class="admin-actions">
          <button class="btn btn-primary" id="resetDataBtn">
            <span>🔄</span> 데모 데이터 리셋
          </button>
          <div class="admin-user">
            <span>관리자님</span>
            <button class="btn" onclick="auth.logout()">로그아웃</button>
          </div>
        </div>
      </div>

      <!-- KPI 카드들 -->
      <div class="kpi-section">
        <div class="kpi-grid" id="kpiCards">
          <!-- 동적으로 로드됩니다 -->
        </div>
      </div>

      <!-- 탭 네비게이션 -->
      <div class="admin-tabs">
        <nav class="tabs" id="adminTabs">
          <ul class="tabs-nav">
            <li><button class="tab-btn active" data-tab="dashboard">대시보드</button></li>
            <li><button class="tab-btn" data-tab="facilities">체육시설</button></li>
            <li><button class="tab-btn" data-tab="coaches">지도자</button></li>
            <li><button class="tab-btn" data-tab="programs">프로그램</button></li>
            <li><button class="tab-btn" data-tab="notices">공지사항</button></li>
            <li><button class="tab-btn" data-tab="users">회원관리</button></li>
            <li><button class="tab-btn" data-tab="bookings">예약관리</button></li>
          </ul>
        </nav>

        <!-- 대시보드 탭 -->
        <div class="tab-content active" id="dashboard">
          <div class="dashboard-section">
            <h2>최근 활동</h2>
            <div class="activity-cards">
              <div class="activity-card">
                <h3>오늘의 예약</h3>
                <div class="activity-stats">
                  <span class="stat-number" id="todayBookings">0</span>
                  <span class="stat-label">건</span>
                </div>
              </div>
              <div class="activity-card">
                <h3>신규 회원</h3>
                <div class="activity-stats">
                  <span class="stat-number" id="newUsers">0</span>
                  <span class="stat-label">명</span>
                </div>
              </div>
              <div class="activity-card">
                <h3>이용률</h3>
                <div class="activity-stats">
                  <span class="stat-number" id="utilizationRate">0</span>
                  <span class="stat-label">%</span>
                </div>
              </div>
            </div>
            
            <div class="quick-actions">
              <h3>빠른 작업</h3>
              <div class="quick-action-grid">
                <button class="quick-action-btn" data-action="add-facility">
                  <span class="action-icon">🏢</span>
                  <span>시설 추가</span>
                </button>
                <button class="quick-action-btn" data-action="add-program">
                  <span class="action-icon">📝</span>
                  <span>프로그램 추가</span>
                </button>
                <button class="quick-action-btn" data-action="add-coach">
                  <span class="action-icon">👨‍🏫</span>
                  <span>지도자 추가</span>
                </button>
                <button class="quick-action-btn" data-action="add-notice">
                  <span class="action-icon">📢</span>
                  <span>공지사항 작성</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- 체육시설 탭 -->
        <div class="tab-content" id="facilities">
          <div class="content-header">
            <h2>체육시설 관리</h2>
            <button class="btn btn-primary" id="addFacilityBtn">+ 새 시설 추가</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="시설 검색..." class="table-search" data-table="facilities">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="facilities" data-field="status">
                <option value="">전체 상태</option>
                <option value="active">운영중</option>
                <option value="inactive">휴업</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="facilitiesTable">
              <thead>
                <tr>
                  <th>시설명</th>
                  <th>유형</th>
                  <th>지역</th>
                  <th>상태</th>
                  <th>평점</th>
                  <th>등록일</th>
                  <th>작업</th>
                </tr>
              </thead>
              <tbody>
                <!-- 동적으로 로드됩니다 -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="facilitiesPagination"></div>
        </div>

        <!-- 지도자 탭 -->
        <div class="tab-content" id="coaches">
          <div class="content-header">
            <h2>지도자 관리</h2>
            <button class="btn btn-primary" id="addCoachBtn">+ 새 지도자 등록</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="지도자 검색..." class="table-search" data-table="coaches">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="coaches" data-field="status">
                <option value="">전체 상태</option>
                <option value="active">활동중</option>
                <option value="inactive">휴직</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="coachesTable">
              <thead>
                <tr>
                  <th>이름</th>
                  <th>전문분야</th>
                  <th>경력</th>
                  <th>평점</th>
                  <th>시급</th>
                  <th>상태</th>
                  <th>작업</th>
                </tr>
              </thead>
              <tbody>
                <!-- 동적으로 로드됩니다 -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="coachesPagination"></div>
        </div>

        <!-- 프로그램 탭 -->
        <div class="tab-content" id="programs">
          <div class="content-header">
            <h2>프로그램 관리</h2>
            <button class="btn btn-primary" id="addProgramBtn">+ 새 프로그램 추가</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="프로그램 검색..." class="table-search" data-table="programs">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="programs" data-field="status">
                <option value="">전체 상태</option>
                <option value="active">운영중</option>
                <option value="inactive">중단</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="programsTable">
              <thead>
                <tr>
                  <th>프로그램명</th>
                  <th>카테고리</th>
                  <th>수준</th>
                  <th>정원</th>
                  <th>현재인원</th>
                  <th>가격</th>
                  <th>상태</th>
                  <th>작업</th>
                </tr>
              </thead>
              <tbody>
                <!-- 동적으로 로드됩니다 -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="programsPagination"></div>
        </div>

        <!-- 공지사항 탭 -->
        <div class="tab-content" id="notices">
          <div class="content-header">
            <h2>공지사항 관리</h2>
            <button class="btn btn-primary" id="addNoticeBtn">+ 새 공지사항 작성</button>
          </div>
          <div class="table-controls">
            <div class="search-wrapper">
              <input type="search" placeholder="공지사항 검색..." class="table-search" data-table="notices">
            </div>
            <div class="filter-wrapper">
              <select class="table-filter" data-table="notices" data-field="status">
                <option value="">전체 상태</option>
                <option value="published">게시됨</option>
                <option value="draft">임시저장</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="table" id="noticesTable">
              <thead>
                <tr>
                  <th>제목</th>
                  <th>카테고리</th>
                  <th>우선순위</th>
                  <th>조회수</th>
                  <th>상태</th>
                  <th>작성일</th>
                  <th>작업</th>
                </tr>
              </thead>
              <tbody>
                <!-- 동적으로 로드됩니다 -->
              </tbody>
            </table>
          </div>
          <div class="table-pagination" id="noticesPagination"></div>
        </div>

        <!-- 회원관리 탭 -->
        <div class="tab-content" id="users">
          <div class="content-header">
            <h2>회원 관리</h2>
            <div class="header-stats">
              <span>총 회원수: <strong id="totalUsers">0</strong>명</span>
            </div>
          </div>
          <div class="users-placeholder">
            <div class="placeholder-content">
              <div class="placeholder-icon">👥</div>
              <h3>회원 관리 시스템</h3>
              <p>실제 서비스에서는 여기에 회원 목록과 관리 기능이 표시됩니다.</p>
              <div class="placeholder-features">
                <div class="feature">✓ 회원 정보 조회 및 수정</div>
                <div class="feature">✓ 회원 등급 관리</div>
                <div class="feature">✓ 활동 내역 조회</div>
                <div class="feature">✓ 탈퇴 처리</div>
              </div>
            </div>
          </div>
        </div>

        <!-- 예약관리 탭 -->
        <div class="tab-content" id="bookings">
          <div class="content-header">
            <h2>예약 관리</h2>
            <div class="header-stats">
              <span>총 예약수: <strong id="totalBookings">0</strong>건</span>
            </div>
          </div>
          <div class="bookings-list" id="bookingsList">
            <!-- 동적으로 로드됩니다 -->
          </div>
        </div>
      </div>
    </div>

    <!-- 모달 영역 -->
    <div id="modalContainer"></div>
  </main>
  
  <footer id="site-footer"></footer>

  <script type="module" defer>
    import { mountHeader, mountFooter, mountBreadcrumb } from '/components/layout.js';
    import { auth } from '/js/auth.js';
    import { store } from '/js/store.js';
    import UIComponents from '/js/ui.js';
    
    // 인증 체크
    if (!auth.guard('admin')) {
      // auth.js에서 자동으로 리디렉션됨
    }

    // 레이아웃 마운트
    mountHeader(document.getElementById('site-header'), { activePath: '/admin/' });
    mountBreadcrumb(document.getElementById('breadcrumb'), [
      { label: '홈', href: '/' }, 
      { label: '관리자' }
    ]);
    mountFooter(document.getElementById('site-footer'));

    // 관리자 대시보드 클래스
    class AdminDashboard {
      constructor() {
        this.currentPage = {};
        this.init();
      }

      async init() {
        this.setupTabs();
        this.setupEventListeners();
        await this.loadDashboardData();
      }

      setupTabs() {
        UIComponents.initTabs(document.getElementById('adminTabs'));
      }

      setupEventListeners() {
        // 데이터 리셋 버튼
        document.getElementById('resetDataBtn').addEventListener('click', () => {
          this.resetDemoData();
        });

        // 탭 변경 이벤트
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', async () => {
            const tabName = btn.dataset.tab;
            await this.loadTabData(tabName);
          });
        });

        // 빠른 작업 버튼들
        document.querySelectorAll('.quick-action-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const action = btn.dataset.action;
            this.handleQuickAction(action);
          });
        });

        // 추가 버튼들
        document.getElementById('addFacilityBtn')?.addEventListener('click', () => this.showAddModal('facilities'));
        document.getElementById('addCoachBtn')?.addEventListener('click', () => this.showAddModal('coaches'));
        document.getElementById('addProgramBtn')?.addEventListener('click', () => this.showAddModal('programs'));
        document.getElementById('addNoticeBtn')?.addEventListener('click', () => this.showAddModal('notices'));

        // 검색 및 필터
        this.setupTableControls();
      }

      setupTableControls() {
        document.querySelectorAll('.table-search').forEach(input => {
          input.addEventListener('input', UIComponents.debounce(() => {
            const table = input.dataset.table;
            this.filterTable(table);
          }, 300));
        });

        document.querySelectorAll('.table-filter').forEach(select => {
          select.addEventListener('change', () => {
            const table = select.dataset.table;
            this.filterTable(table);
          });
        });
      }

      async loadDashboardData() {
        try {
          // KPI 데이터 로드
          const [facilities, programs, coaches, notices] = await Promise.all([
            store.getData('facilities'),
            store.getData('programs'),
            store.getData('coaches'),
            store.getData('notices')
          ]);

          this.renderKPI({
            facilities: facilities.length,
            programs: programs.length,
            coaches: coaches.length,
            notices: notices.length,
            activeFacilities: facilities.filter(f => f.status === 'active').length,
            activePrograms: programs.filter(p => p.status === 'active').length,
          });

          // 활동 통계
          this.updateActivityStats();
          
          // 예약 데이터 로드
          await this.loadBookingsData();

        } catch (error) {
          console.error('Dashboard load error:', error);
          UIComponents.showToast('대시보드 데이터 로딩 중 오류가 발생했습니다.', 'error');
        }
      }

      renderKPI(stats) {
        document.getElementById('kpiCards').innerHTML = `
          <div class="kpi-card">
            <div class="kpi-value">${stats.facilities}</div>
            <div class="kpi-label">총 체육시설</div>
            <div class="kpi-sub">${stats.activeFacilities}개 운영중</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">${stats.programs}</div>
            <div class="kpi-label">총 프로그램</div>
            <div class="kpi-sub">${stats.activePrograms}개 운영중</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">${stats.coaches}</div>
            <div class="kpi-label">전문 지도자</div>
            <div class="kpi-sub">평균 평점 4.7</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">${stats.notices}</div>
            <div class="kpi-label">공지사항</div>
            <div class="kpi-sub">이번 달 신규</div>
          </div>
        `;
      }

      updateActivityStats() {
        // 모의 데이터
        document.getElementById('todayBookings').textContent = '12';
        document.getElementById('newUsers').textContent = '5';
        document.getElementById('utilizationRate').textContent = '78';
      }

      async loadTabData(tabName) {
        switch (tabName) {
          case 'facilities':
            await this.loadFacilitiesTable();
            break;
          case 'coaches':
            await this.loadCoachesTable();
            break;
          case 'programs':
            await this.loadProgramsTable();
            break;
          case 'notices':
            await this.loadNoticesTable();
            break;
          case 'bookings':
            await this.loadBookingsData();
            break;
        }
      }

      async loadFacilitiesTable() {
        try {
          const facilities = await store.getData('facilities');
          const tbody = document.querySelector('#facilitiesTable tbody');
          
          tbody.innerHTML = facilities.map(facility => `
            <tr data-id="${facility.id}">
              <td>
                <div class="table-title">${facility.name}</div>
                <div class="table-sub">${facility.location.district}</div>
              </td>
              <td><span class="badge">${facility.category}</span></td>
              <td>${facility.location.district}</td>
              <td>
                <span class="status status-${facility.status}">
                  <span class="status-dot"></span>
                  ${facility.status === 'active' ? '운영중' : '휴업'}
                </span>
              </td>
              <td>${facility.rating} ⭐</td>
              <td>${new Date(facility.createdAt).toLocaleDateString('ko-KR')}</td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('facilities', '${facility.id}')" title="수정">✏️</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('facilities', '${facility.id}')" title="삭제">🗑️</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Facilities table load error:', error);
        }
      }

      async loadCoachesTable() {
        try {
          const coaches = await store.getData('coaches');
          const tbody = document.querySelector('#coachesTable tbody');
          
          tbody.innerHTML = coaches.map(coach => `
            <tr data-id="${coach.id}">
              <td>
                <div class="table-title">${coach.name}</div>
                <div class="table-sub">${coach.experience}년 경력</div>
              </td>
              <td>
                <div class="specialties-tags">
                  ${coach.specialties.slice(0, 2).map(s => `<span class="tag">${s}</span>`).join('')}
                </div>
              </td>
              <td>${coach.experience}년</td>
              <td>${coach.rating} ⭐</td>
              <td>${coach.hourlyRate.toLocaleString()}원</td>
              <td>
                <span class="status status-${coach.status}">
                  <span class="status-dot"></span>
                  ${coach.status === 'active' ? '활동중' : '휴직'}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('coaches', '${coach.id}')" title="수정">✏️</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('coaches', '${coach.id}')" title="삭제">🗑️</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Coaches table load error:', error);
        }
      }

      async loadProgramsTable() {
        try {
          const programs = await store.getData('programs');
          const tbody = document.querySelector('#programsTable tbody');
          
          tbody.innerHTML = programs.map(program => `
            <tr data-id="${program.id}">
              <td>
                <div class="table-title">${program.title}</div>
                <div class="table-sub">${program.duration}분</div>
              </td>
              <td><span class="badge">${program.category}</span></td>
              <td>
                <span class="level-badge level-${program.level}">
                  ${program.level === 'beginner' ? '초급' : program.level === 'intermediate' ? '중급' : '고급'}
                </span>
              </td>
              <td>${program.maxParticipants}명</td>
              <td>${program.currentParticipants}명</td>
              <td>${program.price.toLocaleString()}원</td>
              <td>
                <span class="status status-${program.status}">
                  <span class="status-dot"></span>
                  ${program.status === 'active' ? '운영중' : '중단'}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('programs', '${program.id}')" title="수정">✏️</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('programs', '${program.id}')" title="삭제">🗑️</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Programs table load error:', error);
        }
      }

      async loadNoticesTable() {
        try {
          const notices = await store.getData('notices');
          const tbody = document.querySelector('#noticesTable tbody');
          
          tbody.innerHTML = notices.map(notice => `
            <tr data-id="${notice.id}">
              <td>
                <div class="table-title">${notice.title}</div>
                <div class="table-sub">by ${notice.author}</div>
              </td>
              <td><span class="badge">${notice.category}</span></td>
              <td>
                <span class="priority priority-${notice.priority}">
                  ${notice.priority === 'high' ? '높음' : notice.priority === 'medium' ? '보통' : '낮음'}
                </span>
              </td>
              <td>${notice.views || 0}</td>
              <td>
                <span class="status status-${notice.status}">
                  <span class="status-dot"></span>
                  ${notice.status === 'published' ? '게시됨' : '임시저장'}
                </span>
              </td>
              <td>${new Date(notice.createdAt).toLocaleDateString('ko-KR')}</td>
              <td>
                <div class="table-actions">
                  <button class="btn-icon" onclick="adminDashboard.editItem('notices', '${notice.id}')" title="수정">✏️</button>
                  <button class="btn-icon" onclick="adminDashboard.deleteItem('notices', '${notice.id}')" title="삭제">🗑️</button>
                </div>
              </td>
            </tr>
          `).join('');
        } catch (error) {
          console.error('Notices table load error:', error);
        }
      }

      async loadBookingsData() {
        try {
          const bookings = JSON.parse(localStorage.getItem('allfit_bookings') || '[]');
          document.getElementById('totalBookings').textContent = bookings.length;
          
          const bookingsList = document.getElementById('bookingsList');
          
          if (bookings.length === 0) {
            bookingsList.innerHTML = `
              <div class="empty-state">
                <div class="empty-icon">📅</div>
                <p>아직 예약이 없습니다.</p>
              </div>
            `;
            return;
          }

          bookingsList.innerHTML = `
            <div class="bookings-grid">
              ${bookings.slice(0, 20).map(booking => `
                <div class="booking-card">
                  <div class="booking-header">
                    <div class="booking-id">${booking.id}</div>
                    <span class="booking-status status-${booking.status}">
                      ${booking.status === 'pending' ? '대기중' : booking.status === 'confirmed' ? '확정' : '취소'}
                    </span>
                  </div>
                  <div class="booking-details">
                    <div class="booking-info">
                      <strong>${booking.name}</strong>
                      <div>📞 ${booking.phone}</div>
                      <div>📧 ${booking.email}</div>
                    </div>
                    <div class="booking-schedule">
                      <div>📅 ${booking.date}</div>
                      <div>🕐 ${booking.time}</div>
                      <div>👥 ${booking.participants}명</div>
                    </div>
                  </div>
                  <div class="booking-footer">
                    <span class="booking-price">${parseInt(booking.totalPrice).toLocaleString()}원</span>
                    <div class="booking-actions">
                      <button class="btn btn-sm" onclick="adminDashboard.confirmBooking('${booking.id}')">확정</button>
                      <button class="btn btn-sm">취소</button>
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
          `;
        } catch (error) {
          console.error('Bookings load error:', error);
        }
      }

      filterTable(tableName) {
        // 테이블 필터링 구현 (실제로는 더 복잡한 로직)
        console.log(`Filtering ${tableName} table`);
      }

      handleQuickAction(action) {
        switch (action) {
          case 'add-facility':
            this.showAddModal('facilities');
            break;
          case 'add-program':
            this.showAddModal('programs');
            break;
          case 'add-coach':
            this.showAddModal('coaches');
            break;
          case 'add-notice':
            this.showAddModal('notices');
            break;
        }
      }

      showAddModal(type) {
        const titles = {
          facilities: '새 체육시설 추가',
          programs: '새 프로그램 추가',
          coaches: '새 지도자 등록',
          notices: '새 공지사항 작성'
        };

        const content = this.getAddFormContent(type);
        
        UIComponents.showModal(content, {
          title: titles[type],
          size: 'large'
        });
      }

      getAddFormContent(type) {
        // 간단한 폼 (실제로는 더 상세한 폼이 필요)
        switch (type) {
          case 'facilities':
            return `
              <form id="addFacilityForm" class="modal-form">
                <div class="form-group">
                  <label>시설명</label>
                  <input type="text" name="name" required>
                </div>
                <div class="form-group">
                  <label>유형</label>
                  <select name="type" required>
                    <option value="gymnasium">체육관</option>
                    <option value="sports_center">스포츠센터</option>
                    <option value="swimming_pool">수영장</option>
                    <option value="tennis_court">테니스장</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>주소</label>
                  <input type="text" name="address" required>
                </div>
                <div class="form-group">
                  <label>설명</label>
                  <textarea name="description" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                  <button type="button" class="btn" onclick="this.closest('.modal-overlay').querySelector('.modal-close').click()">취소</button>
                  <button type="submit" class="btn btn-primary">추가</button>
                </div>
              </form>
            `;
          default:
            return `
              <div class="modal-placeholder">
                <p>이 기능은 데모 버전에서 구현되지 않았습니다.</p>
                <p>실제 서비스에서는 상세한 추가/편집 폼이 제공됩니다.</p>
              </div>
            `;
        }
      }

      editItem(type, id) {
        UIComponents.showToast(`${type} ${id} 편집 기능은 데모에서 구현되지 않았습니다.`, 'info');
      }

      async deleteItem(type, id) {
        if (confirm('정말 삭제하시겠습니까?')) {
          try {
            await store.delete(type, id);
            UIComponents.showToast('삭제되었습니다.', 'success');
            await this.loadTabData(type);
          } catch (error) {
            console.error('Delete error:', error);
            UIComponents.showToast('삭제 중 오류가 발생했습니다.', 'error');
          }
        }
      }

      confirmBooking(bookingId) {
        // 예약 확정 처리
        UIComponents.showToast(`예약 ${bookingId}이 확정되었습니다.`, 'success');
      }

      resetDemoData() {
        if (confirm('모든 데모 데이터가 초기화됩니다. 계속하시겠습니까?')) {
          store.resetDemoData();
          localStorage.removeItem('allfit_bookings');
          UIComponents.showToast('데모 데이터가 리셋되었습니다.', 'success');
          setTimeout(() => {
            window.location.reload();
          }, 1000);
        }
      }
    }

    // 전역 변수로 설정 (onClick 핸들러용)
    window.adminDashboard = new AdminDashboard();
  </script>

  <style>
    /* 관리자 대시보드 전용 스타일 */
    .admin-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2rem 0;
      border-bottom: 1px solid var(--line);
      margin-bottom: 2rem;
    }

    .admin-title h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .admin-title p {
      color: var(--muted);
      margin: 0;
    }

    .admin-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .admin-user {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding-left: 1rem;
      border-left: 1px solid var(--line);
    }

    .kpi-section {
      margin-bottom: 3rem;
    }

    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .kpi-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 2rem;
      text-align: center;
      transition: all 0.2s ease;
    }

    .kpi-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px var(--shadow);
    }

    .kpi-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--brand);
      margin-bottom: 0.5rem;
    }

    .kpi-label {
      font-size: 1rem;
      color: var(--ink);
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .kpi-sub {
      font-size: 0.875rem;
      color: var(--muted);
    }

    .admin-tabs {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      overflow: hidden;
    }

    .tabs-nav {
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--line);
      padding: 0;
      display: flex;
      overflow-x: auto;
    }

    .tab-btn {
      padding: 1rem 1.5rem;
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-weight: 500;
      white-space: nowrap;
      transition: all 0.2s ease;
      border-bottom: 3px solid transparent;
    }

    .tab-btn:hover {
      background: var(--card);
      color: var(--ink);
    }

    .tab-btn.active {
      color: var(--brand);
      background: var(--card);
      border-bottom-color: var(--brand);
    }

    .tab-content {
      padding: 2rem;
      min-height: 400px;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .header-stats {
      color: var(--muted);
      font-size: 0.9375rem;
    }

    .table-controls {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      align-items: center;
    }

    .search-wrapper,
    .filter-wrapper {
      flex: 1;
      max-width: 300px;
    }

    .table-search,
    .table-filter {
      width: 100%;
    }

    .table-title {
      font-weight: 600;
      color: var(--ink);
    }

    .table-sub {
      font-size: 0.875rem;
      color: var(--muted);
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-icon {
      background: none;
      border: none;
      padding: 0.5rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s ease;
    }

    .btn-icon:hover {
      background: var(--line);
    }

    .specialties-tags,
    .facilities-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
    }

    .level-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.8125rem;
      font-weight: 500;
    }

    .level-beginner { background: rgba(34, 211, 238, 0.1); color: var(--accent); }
    .level-intermediate { background: rgba(245, 158, 11, 0.1); color: var(--warn); }
    .level-advanced { background: rgba(239, 68, 68, 0.1); color: var(--bad); }

    .priority {
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.8125rem;
      font-weight: 500;
    }

    .priority-high { background: rgba(239, 68, 68, 0.1); color: var(--bad); }
    .priority-medium { background: rgba(245, 158, 11, 0.1); color: var(--warn); }
    .priority-low { background: rgba(107, 114, 128, 0.1); color: var(--muted); }

    /* 대시보드 섹션 */
    .dashboard-section h2 {
      margin-bottom: 2rem;
    }

    .activity-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .activity-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 1.5rem;
      text-align: center;
    }

    .activity-card h3 {
      font-size: 1rem;
      color: var(--muted);
      margin-bottom: 1rem;
    }

    .activity-stats {
      display: flex;
      align-items: baseline;
      justify-content: center;
      gap: 0.5rem;
    }

    .activity-stats .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: var(--brand);
    }

    .activity-stats .stat-label {
      color: var(--muted);
    }

    .quick-actions h3 {
      margin-bottom: 1.5rem;
    }

    .quick-action-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
    }

    .quick-action-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
      padding: 1.5rem;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      color: var(--ink);
    }

    .quick-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px var(--shadow);
      border-color: var(--brand);
    }

    .action-icon {
      font-size: 2rem;
    }

    /* 예약 관리 */
    .bookings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1.5rem;
    }

    .booking-card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 1.5rem;
    }

    .booking-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .booking-id {
      font-weight: 600;
      color: var(--muted);
      font-size: 0.875rem;
    }

    .booking-details {
      margin-bottom: 1rem;
    }

    .booking-info,
    .booking-schedule {
      margin-bottom: 0.75rem;
    }

    .booking-info strong {
      display: block;
      color: var(--ink);
      margin-bottom: 0.5rem;
    }

    .booking-info div,
    .booking-schedule div {
      font-size: 0.875rem;
      color: var(--muted);
      margin-bottom: 0.25rem;
    }

    .booking-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .booking-price {
      font-weight: 700;
      color: var(--brand);
    }

    .booking-actions {
      display: flex;
      gap: 0.5rem;
    }

    .booking-status {
      font-size: 0.8125rem;
    }

    /* 플레이스홀더 */
    .users-placeholder,
    .modal-placeholder {
      text-align: center;
      padding: 3rem;
      color: var(--muted);
    }

    .placeholder-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .placeholder-features {
      margin-top: 2rem;
    }

    .feature {
      margin-bottom: 0.5rem;
      color: var(--ink-secondary);
    }

    /* 모달 폼 */
    .modal-form {
      max-width: 500px;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--line);
    }

    /* 반응형 */
    @media (max-width: 768px) {
      .admin-header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }
      
      .admin-actions {
        flex-direction: column;
      }
      
      .admin-user {
        border-left: none;
        border-top: 1px solid var(--line);
        padding-left: 0;
        padding-top: 1rem;
      }
      
      .content-header {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
      }
      
      .table-controls {
        flex-direction: column;
      }
      
      .search-wrapper,
      .filter-wrapper {
        max-width: none;
      }
    }
  </style>
</body>
</html>
